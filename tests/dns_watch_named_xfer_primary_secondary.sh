#!/usr/bin/env bash
if [ -e /var/log/messages ]; then
  SYSLOG_PATH='/var/log/messages'
elif [ -e /var/log/syslog ]
then
  SYSLOG_PATH='/var/log/syslog'
else
  echo "!!!!!!!!!! No Logfiles Detected !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"
  exit
fi

echo "!!!!!!!!!! Detected /var/log/messages !!!!!!!!!!!!!!!!!!!!!!!!"
echo "?????????? Waiting for BIND named XFER ???????????????????????"
tail -f ${SYSLOG_PATH} | grep --line-buffered -Ei 'AXFR started' -m 2
echo "!!!!!!!!!! Named XFER Successfully Detected !!!!!!!!!!!!!!!!!!"
echo "?????????? Waiting for DHCP Cluster Recovery ?????????????????"
tail -f ${SYSLOG_PATH} | grep --line-buffered -Ei 'Both servers have entered recover-done!' -m 1
echo "!!!!!!!!!! Cluster recovery successfully detected !!!!!!!!!!!!"
echo "?????????? Checking for DyN DNS ??????????????????????????????"
cat ${SYSLOG_PATH} | grep --line-buffered -Ei 'generating session key for dynamic DNS'-m 2
