#!/usr/bin/env bash
if [ -e /var/log/messages ]; then
  echo "!!!!!!!!!! Detected /var/log/messages !!!!!!!!!!!!!!!!!!!!!!!!"
  echo "?????????? Waiting for BIND named XFER ???????????????????????"
  tail -f /var/log/messages | grep --line-buffered -Ei 'AXFR started' -m 2
  echo "!!!!!!!!!! Named XFER Successfully Detected !!!!!!!!!!!!!!!!!!"
  echo "?????????? Waiting for DHCP Cluster Recovery ?????????????????"
  tail -f /var/log/messages | grep --line-buffered -Ei 'Both servers have entered recover-done!' -m 1
  echo "!!!!!!!!!! Cluster recovery successfully detected !!!!!!!!!!!!"
fi

if [ -e /var/log/syslog ]; then
  echo "!!!!!!!!!! Detected /var/log/messages !!!!!!!!!!!!!!!!!!!!!!!!"
  echo "?????????? Waiting for BIND named XFER ???????????????????????"
  tail -f /var/log/syslog | grep --line-buffered -Ei 'AXFR started' -m 2
  echo "!!!!!!!!!! Named XFER Successfully Detected !!!!!!!!!!!!!!!!!!"
  echo "?????????? Waiting for DHCP Cluster Recovery ?????????????????"
  tail -f /var/log/syslog | grep --line-buffered -Ei 'Both servers have entered recover-done!' -m 1
  echo "!!!!!!!!!! Cluster recovery successfully detected !!!!!!!!!!!!"
fi



